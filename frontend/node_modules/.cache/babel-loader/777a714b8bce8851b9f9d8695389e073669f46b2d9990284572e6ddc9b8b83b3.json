{"ast":null,"code":"//compile doT templates to js functions\n'use strict';\n\nvar glob = require('glob'),\n  fs = require('fs'),\n  path = require('path'),\n  doT = require('dot'),\n  beautify = require('js-beautify').js_beautify;\nvar defsRootPath = process.argv[2] || path.join(__dirname, '../lib');\nvar defs = {};\nvar defFiles = glob.sync('./dot/**/*.def', {\n  cwd: defsRootPath\n});\ndefFiles.forEach(function (f) {\n  var name = path.basename(f, '.def');\n  defs[name] = fs.readFileSync(path.join(defsRootPath, f));\n});\nvar filesRootPath = process.argv[3] || path.join(__dirname, '../lib');\nvar files = glob.sync('./dot/**/*.jst', {\n  cwd: filesRootPath\n});\nvar dotjsPath = path.join(filesRootPath, './dotjs');\ntry {\n  fs.mkdirSync(dotjsPath);\n} catch (e) {}\nconsole.log('\\n\\nCompiling:');\nvar FUNCTION_NAME = /function\\s+anonymous\\s*\\(it[^)]*\\)\\s*{/;\nvar OUT_EMPTY_STRING = /out\\s*\\+=\\s*'\\s*';/g;\nvar ISTANBUL = /'(istanbul[^']+)';/g;\nvar ERROR_KEYWORD = /\\$errorKeyword/g;\nvar ERROR_KEYWORD_OR = /\\$errorKeyword\\s+\\|\\|/g;\nvar VARS = ['$errs', '$valid', '$lvl', '$data', '$dataLvl', '$errorKeyword', '$closingBraces', '$schemaPath', '$validate'];\nfiles.forEach(function (f) {\n  var keyword = path.basename(f, '.jst');\n  var targetPath = path.join(dotjsPath, keyword + '.js');\n  var template = fs.readFileSync(path.join(filesRootPath, f));\n  var code = doT.compile(template, defs);\n  code = code.toString().replace(OUT_EMPTY_STRING, '').replace(FUNCTION_NAME, 'function generate_' + keyword + '(it, $keyword, $ruleType) {').replace(ISTANBUL, '/* $1 */');\n  removeAlwaysFalsyInOr();\n  VARS.forEach(removeUnusedVar);\n  code = \"'use strict';\\nmodule.exports = \" + code;\n  code = beautify(code, {\n    indent_size: 2\n  }) + '\\n';\n  fs.writeFileSync(targetPath, code);\n  console.log('compiled', keyword);\n  function removeUnusedVar(v) {\n    v = v.replace(/\\$/g, '\\\\$$');\n    var regexp = new RegExp(v + '[^A-Za-z0-9_$]', 'g');\n    var count = occurrences(regexp);\n    if (count == 1) {\n      regexp = new RegExp('var\\\\s+' + v + '\\\\s*=[^;]+;|var\\\\s+' + v + ';');\n      code = code.replace(regexp, '');\n    }\n  }\n  function removeAlwaysFalsyInOr() {\n    var countUsed = occurrences(ERROR_KEYWORD);\n    var countOr = occurrences(ERROR_KEYWORD_OR);\n    if (countUsed == countOr + 1) code = code.replace(ERROR_KEYWORD_OR, '');\n  }\n  function occurrences(regexp) {\n    return (code.match(regexp) || []).length;\n  }\n});","map":{"version":3,"names":["glob","require","fs","path","doT","beautify","js_beautify","defsRootPath","process","argv","join","__dirname","defs","defFiles","sync","cwd","forEach","f","name","basename","readFileSync","filesRootPath","files","dotjsPath","mkdirSync","e","console","log","FUNCTION_NAME","OUT_EMPTY_STRING","ISTANBUL","ERROR_KEYWORD","ERROR_KEYWORD_OR","VARS","keyword","targetPath","template","code","compile","toString","replace","removeAlwaysFalsyInOr","removeUnusedVar","indent_size","writeFileSync","v","regexp","RegExp","count","occurrences","countUsed","countOr","match","length"],"sources":["C:/Users/chest/OneDrive/Documentos/GitHub/HackUPC/frontend/node_modules/ajv/scripts/compile-dots.js"],"sourcesContent":["//compile doT templates to js functions\n'use strict';\n\nvar glob = require('glob')\n  , fs = require('fs')\n  , path = require('path')\n  , doT = require('dot')\n  , beautify = require('js-beautify').js_beautify;\n\nvar defsRootPath = process.argv[2] || path.join(__dirname, '../lib');\n\nvar defs = {};\nvar defFiles = glob.sync('./dot/**/*.def', { cwd: defsRootPath });\ndefFiles.forEach(function (f) {\n  var name = path.basename(f, '.def');\n  defs[name] = fs.readFileSync(path.join(defsRootPath, f));\n});\n\nvar filesRootPath = process.argv[3] || path.join(__dirname, '../lib');\nvar files = glob.sync('./dot/**/*.jst', { cwd: filesRootPath });\n\nvar dotjsPath = path.join(filesRootPath, './dotjs');\ntry { fs.mkdirSync(dotjsPath); } catch(e) {}\n\nconsole.log('\\n\\nCompiling:');\n\nvar FUNCTION_NAME = /function\\s+anonymous\\s*\\(it[^)]*\\)\\s*{/;\nvar OUT_EMPTY_STRING = /out\\s*\\+=\\s*'\\s*';/g;\nvar ISTANBUL = /'(istanbul[^']+)';/g;\nvar ERROR_KEYWORD = /\\$errorKeyword/g;\nvar ERROR_KEYWORD_OR = /\\$errorKeyword\\s+\\|\\|/g;\nvar VARS = [\n  '$errs', '$valid', '$lvl', '$data', '$dataLvl',\n  '$errorKeyword', '$closingBraces', '$schemaPath',\n  '$validate'\n];\n\nfiles.forEach(function (f) {\n  var keyword = path.basename(f, '.jst');\n  var targetPath = path.join(dotjsPath, keyword + '.js');\n  var template = fs.readFileSync(path.join(filesRootPath, f));\n  var code = doT.compile(template, defs);\n  code = code.toString()\n             .replace(OUT_EMPTY_STRING, '')\n             .replace(FUNCTION_NAME, 'function generate_' + keyword + '(it, $keyword, $ruleType) {')\n             .replace(ISTANBUL, '/* $1 */');\n  removeAlwaysFalsyInOr();\n  VARS.forEach(removeUnusedVar);\n  code = \"'use strict';\\nmodule.exports = \" + code;\n  code = beautify(code, { indent_size: 2 }) + '\\n';\n  fs.writeFileSync(targetPath, code);\n  console.log('compiled', keyword);\n\n  function removeUnusedVar(v) {\n    v = v.replace(/\\$/g, '\\\\$$');\n    var regexp = new RegExp(v + '[^A-Za-z0-9_$]', 'g');\n    var count = occurrences(regexp);\n    if (count == 1) {\n      regexp = new RegExp('var\\\\s+' + v + '\\\\s*=[^;]+;|var\\\\s+' + v + ';');\n      code = code.replace(regexp, '');\n    }\n  }\n\n  function removeAlwaysFalsyInOr() {\n    var countUsed = occurrences(ERROR_KEYWORD);\n    var countOr = occurrences(ERROR_KEYWORD_OR);\n    if (countUsed == countOr + 1) code = code.replace(ERROR_KEYWORD_OR, '');\n  }\n\n  function occurrences(regexp) {\n    return (code.match(regexp) || []).length;\n  }\n});\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}