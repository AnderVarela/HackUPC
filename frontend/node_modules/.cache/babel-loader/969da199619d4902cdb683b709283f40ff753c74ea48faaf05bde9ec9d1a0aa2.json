{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function () {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst utils_1 = require(\"@typescript-eslint/utils\");\nconst util = __importStar(require(\"../util\"));\nconst getMemberExpressionName = member => {\n  if (!member.computed) {\n    return member.property.name;\n  }\n  if (member.property.type === utils_1.AST_NODE_TYPES.Literal && typeof member.property.value === 'string') {\n    return member.property.value;\n  }\n  return null;\n};\nexports.default = util.createRule({\n  name: 'prefer-reduce-type-parameter',\n  meta: {\n    type: 'problem',\n    docs: {\n      description: 'Enforce using type parameter when calling `Array#reduce` instead of casting',\n      recommended: 'strict',\n      requiresTypeChecking: true\n    },\n    messages: {\n      preferTypeParameter: 'Unnecessary cast: Array#reduce accepts a type parameter for the default value.'\n    },\n    fixable: 'code',\n    schema: []\n  },\n  defaultOptions: [],\n  create(context) {\n    const service = util.getParserServices(context);\n    const checker = service.program.getTypeChecker();\n    return {\n      'CallExpression > MemberExpression.callee'(callee) {\n        if (getMemberExpressionName(callee) !== 'reduce') {\n          return;\n        }\n        const [, secondArg] = callee.parent.arguments;\n        if (callee.parent.arguments.length < 2 || !util.isTypeAssertion(secondArg)) {\n          return;\n        }\n        // Get the symbol of the `reduce` method.\n        const tsNode = service.esTreeNodeToTSNodeMap.get(callee.object);\n        const calleeObjType = util.getConstrainedTypeAtLocation(checker, tsNode);\n        // Check the owner type of the `reduce` method.\n        if (checker.isArrayType(calleeObjType)) {\n          context.report({\n            messageId: 'preferTypeParameter',\n            node: secondArg,\n            fix: fixer => {\n              const fixes = [fixer.removeRange([secondArg.range[0], secondArg.expression.range[0]]), fixer.removeRange([secondArg.expression.range[1], secondArg.range[1]])];\n              if (!callee.parent.typeParameters) {\n                fixes.push(fixer.insertTextAfter(callee, `<${context.getSourceCode().getText(secondArg.typeAnnotation)}>`));\n              }\n              return fixes;\n            }\n          });\n          return;\n        }\n      }\n    };\n  }\n});","map":{"version":3,"names":["utils_1","require","util","__importStar","getMemberExpressionName","member","computed","property","name","type","AST_NODE_TYPES","Literal","value","exports","default","createRule","meta","docs","description","recommended","requiresTypeChecking","messages","preferTypeParameter","fixable","schema","defaultOptions","create","context","service","getParserServices","checker","program","getTypeChecker","CallExpression > MemberExpression.callee","callee","secondArg","parent","arguments","length","isTypeAssertion","tsNode","esTreeNodeToTSNodeMap","get","object","calleeObjType","getConstrainedTypeAtLocation","isArrayType","report","messageId","node","fix","fixer","fixes","removeRange","range","expression","typeParameters","push","insertTextAfter","getSourceCode","getText","typeAnnotation"],"sources":["../../src/rules/prefer-reduce-type-parameter.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,MAAAA,OAAA,GAAAC,OAAA;AAEA,MAAAC,IAAA,GAAAC,YAAA,CAAAF,OAAA;AAMA,MAAMG,uBAAuB,GAC3BC,MAAiC,IAChB;EACjB,IAAI,CAACA,MAAM,CAACC,QAAQ,EAAE;IACpB,OAAOD,MAAM,CAACE,QAAQ,CAACC,IAAI;;EAG7B,IACEH,MAAM,CAACE,QAAQ,CAACE,IAAI,KAAKT,OAAA,CAAAU,cAAc,CAACC,OAAO,IAC/C,OAAON,MAAM,CAACE,QAAQ,CAACK,KAAK,KAAK,QAAQ,EACzC;IACA,OAAOP,MAAM,CAACE,QAAQ,CAACK,KAAK;;EAG9B,OAAO,IAAI;AACb,CAAC;AAEDC,OAAA,CAAAC,OAAA,GAAeZ,IAAI,CAACa,UAAU,CAAC;EAC7BP,IAAI,EAAE,8BAA8B;EACpCQ,IAAI,EAAE;IACJP,IAAI,EAAE,SAAS;IACfQ,IAAI,EAAE;MACJC,WAAW,EACT,6EAA6E;MAC/EC,WAAW,EAAE,QAAQ;MACrBC,oBAAoB,EAAE;KACvB;IACDC,QAAQ,EAAE;MACRC,mBAAmB,EACjB;KACH;IACDC,OAAO,EAAE,MAAM;IACfC,MAAM,EAAE;GACT;EACDC,cAAc,EAAE,EAAE;EAClBC,MAAMA,CAACC,OAAO;IACZ,MAAMC,OAAO,GAAG1B,IAAI,CAAC2B,iBAAiB,CAACF,OAAO,CAAC;IAC/C,MAAMG,OAAO,GAAGF,OAAO,CAACG,OAAO,CAACC,cAAc,EAAE;IAEhD,OAAO;MACL,0CAA0CC,CACxCC,MAAgD;QAEhD,IAAI9B,uBAAuB,CAAC8B,MAAM,CAAC,KAAK,QAAQ,EAAE;UAChD;;QAGF,MAAM,GAAGC,SAAS,CAAC,GAAGD,MAAM,CAACE,MAAM,CAACC,SAAS;QAE7C,IACEH,MAAM,CAACE,MAAM,CAACC,SAAS,CAACC,MAAM,GAAG,CAAC,IAClC,CAACpC,IAAI,CAACqC,eAAe,CAACJ,SAAS,CAAC,EAChC;UACA;;QAGF;QACA,MAAMK,MAAM,GAAGZ,OAAO,CAACa,qBAAqB,CAACC,GAAG,CAACR,MAAM,CAACS,MAAM,CAAC;QAC/D,MAAMC,aAAa,GAAG1C,IAAI,CAAC2C,4BAA4B,CACrDf,OAAO,EACPU,MAAM,CACP;QAED;QACA,IAAIV,OAAO,CAACgB,WAAW,CAACF,aAAa,CAAC,EAAE;UACtCjB,OAAO,CAACoB,MAAM,CAAC;YACbC,SAAS,EAAE,qBAAqB;YAChCC,IAAI,EAAEd,SAAS;YACfe,GAAG,EAAEC,KAAK,IAAG;cACX,MAAMC,KAAK,GAAG,CACZD,KAAK,CAACE,WAAW,CAAC,CAChBlB,SAAS,CAACmB,KAAK,CAAC,CAAC,CAAC,EAClBnB,SAAS,CAACoB,UAAU,CAACD,KAAK,CAAC,CAAC,CAAC,CAC9B,CAAC,EACFH,KAAK,CAACE,WAAW,CAAC,CAChBlB,SAAS,CAACoB,UAAU,CAACD,KAAK,CAAC,CAAC,CAAC,EAC7BnB,SAAS,CAACmB,KAAK,CAAC,CAAC,CAAC,CACnB,CAAC,CACH;cAED,IAAI,CAACpB,MAAM,CAACE,MAAM,CAACoB,cAAc,EAAE;gBACjCJ,KAAK,CAACK,IAAI,CACRN,KAAK,CAACO,eAAe,CACnBxB,MAAM,EACN,IAAIP,OAAO,CACRgC,aAAa,EAAE,CACfC,OAAO,CAACzB,SAAS,CAAC0B,cAAc,CAAC,GAAG,CACxC,CACF;;cAGH,OAAOT,KAAK;YACd;WACD,CAAC;UAEF;;MAEJ;KACD;EACH;CACD,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}